<!DOCTYPE html>
<html lang="ja" dir="ltr">
	<head>
		<meta charset="utf-8">
		<title></title>
		<script type="module">
			const escape = {
				'<': '&lt;',
				'>': '&gt;',
				'&': '&amp;',
				'"': '&quot;',
				"'": '&#39;',
				'`': '&#x60;'
			};
			function escapeHTML(str) {
				return str.replace(/[<>&"'`]/g, (match) => escape[match]);
			}
			const { body } = await fetch("/message");
			console.log(body)
			const fizzbuzzStream = body.pipeThrough(new TextDecoderStream());
			const reader = fizzbuzzStream.getReader();
			while (true) {
				const {done, value} = await reader.read();
				if (done) {
					break;
				}
				document.body.insertAdjacentHTML('beforeEnd', `<div>${escapeHTML(value)}</div>`);
			}
		</script>
	</head>
	<body>
	</body>
</html>
